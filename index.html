<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‹å‹•é«”é©èƒ½é…å°æŒ‘æˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3b82f6; /* Blue-500 */
            --secondary-color: #10b981; /* Emerald-500 */
            --bg-dark: #1f2937; /* Gray-800 */
            --bg-light: #f3f4f6; /* Gray-100 */
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f172a 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .game-card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .role-item {
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
            background-color: #f0f9ff; /* Blue-50 */
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: 700;
        }

        .role-item:active {
            cursor: grabbing;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.8);
        }

        .fitness-slot {
            background-color: var(--bg-light);
            border: 2px dashed #9ca3af; /* Gray-400 */
            transition: background-color 0.2s, border-color 0.2s;
        }

        .fitness-slot.drag-over {
            background-color: #d1fae5; /* Emerald-100 */
            border-color: var(--secondary-color);
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        .match-correct {
            background-color: var(--secondary-color) !important;
            color: white !important;
            border-color: var(--secondary-color) !important;
            cursor: default !important;
            pointer-events: none; /* Prevent further dragging/dropping */
        }

        .match-correct .fitness-text {
            color: white;
        }

        .invisible-role {
            /* Placeholder for the empty slot after dragging */
            visibility: hidden;
            height: 4.5rem; /* Match the role-item height */
            margin-bottom: 0.75rem; /* Match the role-item margin */
        }

        /* Responsive adjustments for mobile */
        @media (max-width: 768px) {
            .game-card {
                padding: 1.5rem;
            }
            .role-item, .fitness-slot {
                height: auto;
                min-height: 4rem;
                justify-content: flex-start;
                padding: 1rem;
            }
            .role-item span, .fitness-slot span {
                font-size: 1.125rem; /* text-lg */
            }
        }
    </style>
</head>
<body>

    <div id="gameContainer" class="game-card max-w-4xl w-full p-6 sm:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-6 text-center">
            é‹å‹•é«”é©èƒ½é…å°æŒ‘æˆ°
        </h1>
        <p class="text-gray-600 mb-8 text-center">å°‡å·¦å´çš„é‹å‹•è§’è‰²æ‹–æ›³åˆ°å³å´ï¼Œèˆ‡å…¶æœ€é‡è¦çš„é«”é©èƒ½è¦ç´ é€²è¡Œé…å°ã€‚å®Œæˆæ‰€æœ‰é…å°ï¼Œä»¥æ¸¬è©¦æ‚¨çš„ç†è§£ï¼</p>

        <!-- Game Area -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

            <!-- Roles to Drag (Left Side) -->
            <div>
                <h2 class="text-xl font-bold mb-4 text-gray-700">é‹å‹•è§’è‰² (æ‹–æ›³å¡ç‰‡)</h2>
                <div id="rolesList" class="space-y-3">
                    <!-- Roles will be dynamically inserted here -->
                </div>
            </div>

            <!-- Fitness Slots (Right Side) -->
            <div>
                <h2 class="text-xl font-bold mb-4 text-gray-700">æ ¸å¿ƒé«”é©èƒ½ (æ”¾ç½®å€)</h2>
                <div id="fitnessSlots" class="space-y-3">
                    <!-- Slots will be dynamically inserted here -->
                </div>
            </div>

        </div>

        <!-- Result/Control Area -->
        <div class="mt-8 pt-6 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center">
            <div id="resultMessage" class="text-xl font-bold text-gray-700 mb-4 sm:mb-0">
                <!-- Message area -->
            </div>
            <button id="resetButton" class="w-full sm:w-auto px-6 py-3 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 transition duration-300">
                é‡æ–°é–‹å§‹éŠæˆ²
            </button>
        </div>

    </div>

    <script>
        // éŠæˆ²è³‡æ–™åº«ï¼šè§’è‰²èˆ‡å…¶æ‰€éœ€çš„æ ¸å¿ƒé«”é©èƒ½ (id å¿…é ˆå”¯ä¸€ä¸”ç”¨æ–¼é…å°)
        const roleFitnessPairs = [
            { id: 1, role: "é¦¬æ‹‰æ¾è·‘è€…", fitness: "å¿ƒè‚ºè€åŠ› (Cardiorespiratory Endurance)", icon: "ğŸƒ" },
            { id: 2, role: "å¥§é‹èˆ‰é‡é¸æ‰‹", fitness: "è‚ŒåŠ› (Muscular Strength)", icon: "ğŸ‹ï¸" },
            { id: 3, role: "ç±ƒçƒçŒç±ƒè€…", fitness: "çˆ†ç™¼åŠ› (Power)", icon: "ğŸ€" },
            { id: 4, role: "è—è¡“é«”æ“é‹å‹•å“¡", fitness: "æŸ”è»Ÿåº¦ (Flexibility)", icon: "ğŸ¤¸" },
            { id: 5, role: "è¶³çƒå®ˆé–€å“¡", fitness: "æ•æ·æ€§ (Agility)", icon: "ğŸ§¤" },
            { id: 6, role: "èŠ­è•¾èˆè€…", fitness: "å¹³è¡¡æ„Ÿ (Balance)", icon: "ğŸ©°" },
            { id: 7, role: "é•·è·é›¢è‡ªè¡Œè»Šæ‰‹", fitness: "è‚Œè€åŠ› (Muscular Endurance)", icon: "ğŸš´" },
            { id: 8, role: "è·†æ‹³é“é¸æ‰‹", fitness: "åæ‡‰æ™‚é–“ (Reaction Time)", icon: "ğŸ¥‹" }
        ];

        const rolesListEl = document.getElementById('rolesList');
        const fitnessSlotsEl = document.getElementById('fitnessSlots');
        const resultMessageEl = document.getElementById('resultMessage');
        const resetButton = document.getElementById('resetButton');

        let matchedCount = 0;
        let totalMatches = roleFitnessPairs.length;
        let currentlyDraggingId = null;

        /**
         * åˆå§‹åŒ–éŠæˆ²ï¼Œç”Ÿæˆè§’è‰²å¡ç‰‡å’Œé«”é©èƒ½æ§½ä½
         */
        function initializeGame() {
            rolesListEl.innerHTML = '';
            fitnessSlotsEl.innerHTML = '';
            resultMessageEl.textContent = 'è«‹é–‹å§‹é…å°ï¼';
            resetButton.style.display = 'none';
            matchedCount = 0;

            // è¤‡è£½ä¸¦æ‰“äº‚è§’è‰²å’Œé«”é©èƒ½çš„é †åº
            const shuffledRoles = [...roleFitnessPairs].sort(() => Math.random() - 0.5);
            const shuffledFitness = [...roleFitnessPairs].sort(() => Math.random() - 0.5);

            // 1. ç”Ÿæˆè§’è‰²å¡ç‰‡ (Draggable Items)
            shuffledRoles.forEach(pair => {
                const roleEl = document.createElement('div');
                roleEl.className = 'role-item p-4 rounded-lg shadow-md flex items-center space-x-3';
                roleEl.setAttribute('draggable', true);
                roleEl.setAttribute('data-role-id', pair.id);
                roleEl.innerHTML = `<span class="text-2xl">${pair.icon}</span> <span class="text-lg">${pair.role}</span>`;
                roleEl.addEventListener('dragstart', handleDragStart);
                rolesListEl.appendChild(roleEl);
            });

            // 2. ç”Ÿæˆé«”é©èƒ½æ§½ä½ (Drop Targets)
            shuffledFitness.forEach(pair => {
                const slotEl = document.createElement('div');
                slotEl.className = 'fitness-slot p-4 rounded-lg flex items-center justify-center h-20';
                slotEl.setAttribute('data-fitness-id', pair.id);
                slotEl.innerHTML = `<span class="fitness-text text-xl font-bold text-gray-600">${pair.fitness}</span>`;
                slotEl.addEventListener('dragover', handleDragOver);
                slotEl.addEventListener('dragleave', handleDragLeave);
                slotEl.addEventListener('drop', handleDrop);
                fitnessSlotsEl.appendChild(slotEl);
            });
            
            // åˆå§‹æ™‚é¡¯ç¤ºé‡ç½®æŒ‰éˆ•ï¼Œä½†è‹¥æœªé–‹å§‹éŠæˆ²å‰‡ä¿æŒéš±è—
            resetButton.style.display = 'none'; 
        }

        /**
         * è™•ç†æ‹–æ›³é–‹å§‹äº‹ä»¶
         * @param {DragEvent} e
         */
        function handleDragStart(e) {
            currentlyDraggingId = e.target.getAttribute('data-role-id');
            e.dataTransfer.setData('text/plain', currentlyDraggingId);
            e.target.classList.add('opacity-50'); // æä¾›æ‹–æ›³è¦–è¦ºåé¥‹
        }

        /**
         * è™•ç†æ‹–æ›³ä¸­åœ¨ç›®æ¨™ä¸Šç§»å‹•
         * @param {DragEvent} e
         */
        function handleDragOver(e) {
            e.preventDefault(); // å…è¨±æ”¾ä¸‹
            // åªå…è¨±æ‹–æ›³åˆ°æœªé…å°çš„æ§½ä½
            if (!e.currentTarget.classList.contains('match-correct')) {
                e.currentTarget.classList.add('drag-over');
            }
        }

        /**
         * è™•ç†æ‹–æ›³é›¢é–‹ç›®æ¨™äº‹ä»¶
         * @param {DragEvent} e
         */
        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        /**
         * è™•ç†æ”¾ä¸‹äº‹ä»¶
         * @param {DragEvent} e
         */
        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');

            const droppedRoleId = e.dataTransfer.getData('text/plain');
            const targetFitnessId = e.currentTarget.getAttribute('data-fitness-id');

            // ç§»é™¤æ‹–æ›³è¦–è¦ºåé¥‹
            const draggedRoleEl = document.querySelector(`.role-item[data-role-id="${droppedRoleId}"]`);
            if (draggedRoleEl) {
                draggedRoleEl.classList.remove('opacity-50');
            }
            
            // æª¢æŸ¥æ˜¯å¦é…å°æˆåŠŸ
            if (droppedRoleId === targetFitnessId) {
                handleSuccessfulMatch(draggedRoleEl, e.currentTarget);
            } else {
                handleFailedMatch(e.currentTarget);
            }
        }

        /**
         * è™•ç†é…å°æˆåŠŸ
         * @param {HTMLElement} roleEl - æ‹–æ›³çš„è§’è‰²å…ƒç´ 
         * @param {HTMLElement} slotEl - æ”¾ç½®çš„æ§½ä½å…ƒç´ 
         */
        function handleSuccessfulMatch(roleEl, slotEl) {
            matchedCount++;

            // 1. è½‰æ›æ§½ä½ç‚ºå·²é…å°ç‹€æ…‹
            slotEl.classList.add('match-correct');
            slotEl.innerHTML = roleEl.innerHTML; // å°‡è§’è‰²å…§å®¹ç§»å‹•åˆ°æ§½ä½

            // 2. ç§»é™¤æ§½ä½çš„æ‹–æ›³äº‹ä»¶ç›£è½å™¨ (é˜²æ­¢å†æ¬¡è¢«æ‹–æ›³)
            slotEl.removeEventListener('dragover', handleDragOver);
            slotEl.removeEventListener('dragleave', handleDragLeave);
            slotEl.removeEventListener('drop', handleDrop);

            // 3. å‰µå»ºä¸€å€‹éš±è—çš„ä½”ä½ç¬¦æ›¿æ›åŸè§’è‰²å¡ç‰‡ï¼Œä»¥ä¿æŒä½ˆå±€ä¸è®Š
            const invisiblePlaceholder = document.createElement('div');
            invisiblePlaceholder.className = 'invisible-role';
            roleEl.parentNode.replaceChild(invisiblePlaceholder, roleEl);
            
            // ç¢ºä¿é‡ç½®æŒ‰éˆ•å¯è¦‹
            resetButton.style.display = 'block';

            // 4. æª¢æŸ¥æ˜¯å¦å®ŒæˆéŠæˆ²
            if (matchedCount === totalMatches) {
                endGame(true);
            } else {
                resultMessageEl.textContent = `âœ… é…å°æˆåŠŸï¼å·²å®Œæˆ ${matchedCount}/${totalMatches} çµ„ã€‚`;
            }
        }

        /**
         * è™•ç†é…å°å¤±æ•—
         * @param {HTMLElement} slotEl - æ”¾ç½®çš„æ§½ä½å…ƒç´ 
         */
        function handleFailedMatch(slotEl) {
            resultMessageEl.textContent = `âŒ é…å°éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼`;
            // é–ƒçˆä¸€ä¸‹å¤±æ•—çš„è¦–è¦ºæ•ˆæœ
            slotEl.style.backgroundColor = '#fca5a5'; // Red-300
            setTimeout(() => {
                slotEl.style.backgroundColor = '';
                resultMessageEl.textContent = `è«‹ç¹¼çºŒé…å°ã€‚`;
            }, 500);
            
            // ç¢ºä¿é‡ç½®æŒ‰éˆ•å¯è¦‹
            resetButton.style.display = 'block';
        }

        /**
         * éŠæˆ²çµæŸ
         * @param {boolean} success - æ˜¯å¦æˆåŠŸå®Œæˆæ‰€æœ‰é…å°
         */
        function endGame(success) {
            if (success) {
                resultMessageEl.textContent = `ğŸ‰ æ­å–œï¼æ‚¨æˆåŠŸé…å°äº†æ‰€æœ‰é«”é©èƒ½è¦ç´ ï¼`;
                resultMessageEl.classList.add('text-secondary-color', 'animate-pulse');
            }
            resetButton.style.display = 'block';
        }

        // è¨­ç½®é‡ç½®æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶
        resetButton.addEventListener('click', () => {
            resultMessageEl.classList.remove('text-secondary-color', 'animate-pulse');
            initializeGame();
        });

        // é¦–æ¬¡åŠ è¼‰æ™‚åˆå§‹åŒ–éŠæˆ²
        window.onload = initializeGame;

    </script>
</body>
</html>
